<!DOCTYPE html>
<html>
    <head>
        <% include ../static/partials/head.ejs %>
    </head>
    <body>

        <% include ../static/partials/navbar.ejs %>

        <% include ../static/partials/messages.ejs %>

        <div id="carouselExampleIndicators" class="carousel slide d-none d-md-block" data-ride="carousel">
            <ol class="carousel-indicators">
                <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active" style="background-image: url(https://i.ibb.co/9nNjv7t/Mantle-1.png);">
                    <div id="callToAction" class="carousel-caption d-none d-md-block">
                        <div class="container">
                            <h1 class="display-1">Our Wikis</h1>
                            <% if(!currentUser) { %>
                                <p class="lead">Want to share your knowledge with the world? Join our community and start dropping some knowledge!</p>
                                <a href="/users/signup" class="btn btn-success">Sign Up</a>
                                <a href="/users/signin" class="btn btn-success">Sign In</a>
                            <% } else { %>
                                <p class="lead">Create a new wiki and share your knowledge!</p>
                                <a href="/wikis/new" class="btn btn-success">Add Wiki</a>
                            <% } %>
                        </div>
                    </div>
                </div>
                <div class="carousel-item" style="background-image: url(https://i.ibb.co/xFbVTgQ/Mantle-1.png);">
                    <div id="featuredWiki" class="carousel-caption d-none d-md-block">
                        <h1 class="display-3">Featured Wiki</h1>
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-12 col-md-12">
                                    <div class="card border-dark mb-1">
                                        <% if(result.featuredWiki === null) { %>
                                            <header class="jumbotron" style="background-image:url(https://images.unsplash.com/photo-1535189043414-47a3c49a0bed?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2689&q=80);background-size: cover; background-position-y: 50%">
                                            </header>
                                            <div class="container">
                                                <div class="row">
                                                    <div class="col-lg-9 col-md-12">
                                                            <div class="card-body text-left">
                                                                <h1 class="card-title display-3">Seoul</h5>
                                                                <hr>
                                                                <p class="card-text">
                                                                    <p id="featureBody">Lorem ipsum dolor sit amet, consectetur adipiscing elit. In non sem et tellus semper vulputate eu nec libero. Cras mi ante, ullamcorper nec enim eget, venenatis aliquet leo. Sed congue erat sodales commodo mollis. Pellentesque sit amet porttitor ipsum. Donec tellus ex, pretium id augue commodo, tempor ultricies velit. Nam mi justo, tincidunt vitae massa ac, consectetur ullamcorper ex. Nullam molestie nec nunc vitae tincidunt. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aenean egestas mattis nunc, eget blandit ligula. Maecenas elit lacus, pellentesque ut velit id, viverra bibendum dolor. Praesent porttitor varius nunc sed imperdiet. Curabitur et lacinia purus. Sed vitae arcu interdum, mattis urna vel, malesuada lectus. Integer vitae quam ut odio faucibus feugiat in quis tellus. Donec cursus metus...</p>
                                                                </p>
                                                                <div><a href="#" class="btn btn-primary btn-sm">View Full Wiki</a></div>
                                                            </div>
                                                        </div>
                                                    <div class="col-lg-3 d-none d-lg-block text-center">
                                                        <figure class="figure">
                                                            <img id="featureImage" src="https://images.unsplash.com/photo-1536315238512-4c8cebdaaf93?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1356&q=80" class="figure-img img-fluid rounded" alt="Profile Picture">
                                                        </figure>
                                                        <div class="jumbotron" id="createdBy">
                                                            <p class="display-4">Created By: <a href="/users/1">premium</a></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        <% } else { %>
                                            <header class="jumbotron" style="background-image:url(<%= result.featuredWiki.headerImage %>);background-size: cover; background-position-y: 50%">
                                            </header>
                                            <div class="container">
                                                <div class="row">
                                                    <div class="col-lg-9 col-md-12">
                                                            <div class="card-body text-left">
                                                                <h1 class="card-title display-3"><%= result.featuredWiki.title %></h5>
                                                                <hr>
                                                                <p class="card-text">
                                                                    <div id="featureBody">
                                                                        <%- result.featuredWiki.body %>...
                                                                    </div>
                                                                </p>
                                                                <div><a href="/wikis/<%= result.featuredWiki.id %>" class="btn btn-primary btn-sm">View Full Wiki</a></div>
                                                            </div>
                                                        </div>
                                                    <div class="col-lg-3 d-none d-lg-block text-center">
                                                        <figure class="figure">
                                                            <img id="featureImage" src="<%= result.featuredWiki.profileImage %>" class="figure-img img-fluid rounded" alt="Profile Picture">
                                                        </figure>
                                                        <div class="jumbotron" id="createdBy">
                                                            <p class="display-4">Created By: <a href="/users/<%= result.featuredWiki.userId %>"><%= result.featuredWiki.username %></a></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>

        <main class="container" id="wiki-list-main">
            <% let col = "col-12" %>
            <% if(currentUser && result.collaborations.length !== 0) { %>
                <% result.collaborations.forEach((collab) => { %>
                    <% result.wikis.forEach((wiki) => { %>
                        <% if(collab.wikiId === wiki.id){ %>
                            <% col = "col-md-7 col-sm-12" %>
                        <% } %>
                    <% }) %>
                <% }) %>
            <% } %>
            <div class="row d-block d-md-none">
                <div class="col-12 text-center">
                    <h1 class="display-1" style="font-size: 80px; margin-bottom: 30px;">Our Wikis</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-md-5 col-sm-12">
                    <% if(currentUser && result.collaborations.length !== 0){ %>
                        <ul class="list-groups wiki-list">
                            <li class="list-group-item list-labels text-center">
                                <span class="display-4">Your Collaborations</span>
                            </li>
                            <% result.collaborations.forEach((collab) => { %>
                                <% result.wikis.forEach((wiki) => { %>
                                    <% if(collab.wikiId === wiki.id){ %>
                                        <a href="/wikis/<%= wiki.id %>">
                                            <li class="list-group-item wiki-list-item">
                                                <% if(wiki.private) { %>
                                                    <i class="fas fa-lock"></i>
                                                <% } %>
                                                <% if(currentUser && (currentUser.id === wiki.userId)) { %>
                                                    <i class="fas fa-user"></i>
                                                <% } %>
                                                <%= wiki.title %>
                                                <span class="float-right d-none d-lg-block"><%= wiki.updatedAt.toString().substring(4, 15) %></span>
                                            </li>
                                        </a>
                                    <% } %>
                                <% }) %>
                            <% }) %>
                        </ul>
                    <% } %>
                </div>
                <div class="<%= col %>">
                    <ul class="list-groups wiki-list">
                        <li class="list-group-item list-labels">
                            <span class="display-4">Title</span>
                            <span class="float-right display-4">Updated</span>
                        </li>
                        <% result.wikis.forEach((wiki) => { %>
                            <a href="/wikis/<%= wiki.id %>">
                                <li class="list-group-item wiki-list-item">
                                    <% if(wiki.private) { %>
                                        <i class="fas fa-lock"></i>
                                    <% } %>
                                    <% if(currentUser && (currentUser.id === wiki.userId)) { %>
                                        <i class="fas fa-user"></i>
                                    <% } %>
                                    <%= wiki.title %>
                                    <span class="float-right"><%= wiki.updatedAt.toString().substring(4, 15) %></span>
                                </li>
                            </a>
                        <% }) %>
                    </ul>
                </div>

            </div>
        </main>

        <% include ../static/partials/baseScripts.ejs %>

    </body>
</html>